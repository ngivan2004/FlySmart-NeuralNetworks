# SameFlightDiffPrice
## Best Time Flight Price Neural Network

![image](https://github.com/ngivan2004/best-time-flight-price-neural-network/assets/61515871/f61a212c-3bed-4080-9935-7bf3267a965f)
![image](https://github.com/ngivan2004/best-time-flight-price-neural-network/assets/61515871/afc7b8cd-28cc-4e0f-afaf-70166bf54a6a)



## Overview

The  project aims to predict the best time to purchase flight tickets at the lowest prices using a neural network model. The model is trained on a dataset scraped from Expedia, containing 82 million rows of flight ticket data between April 16, 2022, and October 5, 2022, for various major airports in the United States.

## Dataset

The dataset used for this project was scraped from purchasable tickets found on Expedia. It included over 82 million searches on around 6 millions flights to and from major US airports and contains several key features:

- **legId**: An identifier for the flight.
- **searchDate**: The date (YYYY-MM-DD) on which this entry was taken from Expedia.
- **flightDate**: The date (YYYY-MM-DD) of the flight.
- **startingAirport**: Three-character IATA airport code for the initial location.
- **destinationAirport**: Three-character IATA airport code for the arrival location.
- **travelDuration**: The travel duration in hours and minutes.
- **isNonStop**: Boolean for whether the flight is non-stop.
- **baseFare**: The price of the ticket (in USD).
- **totalFare**: The price of the ticket (in USD) including taxes and other fees.
- **segmentsCabinCode**: Cabin class for each leg of the trip (e.g., "coach").
- **segmentsAirlineCode**: Airline code of the flight.

- other columns were present but not important for this project and hence ommitted.

### Data Preprocessing

The data underwent extensive cleaning and feature engineering:

1. **Loading Data**: The dataset is loaded in chunks to handle its large size efficiently.
2. **Filtering**: Rows are filtered to keep only non-stop, non-basic economy, non-refundable flights in the coach class.
3. **Date Conversion**: The dates are stripped of their year (as it may be used to predict flights in future years) and a "day of week" feature is implemented to let the model pick up on price variations throughtout the week.
4. **Calculating Days Until Flight**: A new feature representing the number of days until the flight from the search date is calculated.
5. **Finding Minimum Prices**: The lowest price for each flight leg and the corresponding date are tracked and added as a column.
7. **Calculating Lowest Price Day Left**: A new feature representing the number of days left until the flight at the lowest price is calculated.
8. **Dropping Unnecessary Columns**: Several columns that are not required for the model are dropped.
9. **Formatting Dates**: Dates are reformatted to remove the year, focusing on month and day only.
10. **Scaling Data**: The input data is scaled so it has a mean of 0.

## Neural Network Model

### Architecture

The regression neural network is implemented using PyTorch and consists of the following layers:

1. **Input Layer**: Accepts the input features.
2. **Fully Connected Layers**: Four fully connected layers with ReLU activation functions.
3. **Output Layer**: Produces two outputs - the lowest price and the lowest price day left.

### Training

The model is trained using the following steps:

1. **Data Splitting**: The preprocessed data is loaded and split into training and testing sets.
4. **Loss Function**: Mean Squared Error (MSE) loss function is used.
5. **Optimizer**: AdamW optimizer with a learning rate scheduler is used.
7. **Model Checkpointing**: Model weights are saved periodically during training.

### Evaluation

The trained model achieved an accuracy of 84% on the test data.


### Inference

The user finds a flight online and see the current price listed, then enter the information into the model. The model will give a predicted lowest price and als give the date that the ticket is at its lowest price.

## Extra

The dataset used to train this model can be found here: https://github.com/dilwong/FlightPrices


## Limitations


The model is trained on a dataset collected from Expedia between April 16, 2022, and October 5, 2022. As a result, any input data outside of this time span may produce unreasonable or unexplainable outputs, such as negative prices. While during training, the year is stripped from the data and a "day of week" feature is added to account for day of week price differences(e.g. weekend flights), it does not account for events or patterns that occur outside the training period, such as the Christmas peak season. Therefore, predictions for dates or scenarios not represented in the training data, as with all predictions generated by this model, should be interpreted with caution.
